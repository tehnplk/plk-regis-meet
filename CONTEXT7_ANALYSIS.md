# ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ (Context7 Analysis)

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ö‡∏™‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö PLK Regis Meet ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏ï‡πà‡∏≤‡∏á ‡πÜ

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ó‡∏≥:** 24 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2025  
**‡∏£‡∏∞‡∏ö‡∏ö:** PLK Regis Meet - ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°  
**‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ:** Next.js 16, Prisma, SQLite, NextAuth

---

## ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Security Issues)](#1-‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢-security-issues)
2. [‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡πâ‡∏î (Code Quality Issues)](#2-‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡πâ‡∏î-code-quality-issues)
3. [‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Error Handling)](#3-‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î-error-handling)
4. [‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û (Performance Recommendations)](#4-‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û-performance-recommendations)
5. [‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î (Documentation & Code Clarity)](#5-‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î-documentation--code-clarity)
6. [‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° (Architecture Recommendations)](#6-‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°-architecture-recommendations)

---

## 1. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Security Issues)

### üî¥ ‡∏£‡∏∞‡∏î‡∏±‡∏ö CRITICAL

#### 1.1 Hardcoded Secrets ‡πÉ‡∏ô Repository

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** `.env`

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏ñ‡∏π‡∏Å commit ‡πÄ‡∏Ç‡πâ‡∏≤ repository ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö secrets ‡∏à‡∏£‡∏¥‡∏á
- ‡∏°‡∏µ `AUTH_SECRET`, `HEALTH_CLIENT_SECRET`, `PROVIDER_CLIENT_SECRET`, ‡πÅ‡∏•‡∏∞ `JWT_SECRET` ‡∏ñ‡∏π‡∏Å hardcode
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏±‡∏á‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á repository ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡πÇ‡∏°‡∏¢ credentials ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```bash
# 1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå .env ‡πÄ‡∏Ç‡πâ‡∏≤ .gitignore (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
echo ".env" >> .gitignore

# 2. ‡∏•‡∏ö .env ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å git history
git rm --cached .env
git commit -m "Remove .env from repository"

# 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå .env.example ‡πÅ‡∏ó‡∏ô (‡πÑ‡∏°‡πà‡∏°‡∏µ secret ‡∏à‡∏£‡∏¥‡∏á)
cp .env .env.example
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô .env.example ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á `.env.example` ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ:**
```env
# ===== Auth (Development) =====
AUTH_SECRET="your-auth-secret-here"
AUTH_TRUST_HOST=true
AUTH_URL=http://localhost:3000

# ===== Health ID (Development) =====
HEALTH_CLIENT_ID=your-health-client-id
HEALTH_CLIENT_SECRET=your-health-client-secret
HEALTH_REDIRECT_URI=http://localhost:3000/api/auth/healthid

# ===== Provider ID (Development) =====
PROVIDER_CLIENT_ID=your-provider-client-id
PROVIDER_CLIENT_SECRET=your-provider-client-secret

# ===== JWT (Development) =====
JWT_SECRET="your-jwt-secret-here"
```

#### 1.2 Weak JWT Secret Fallback

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** `src/lib/jwt.ts:3`

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
```typescript
const JWT_SECRET = process.env.JWT_SECRET || 'fallback-secret'
```
- ‡∏°‡∏µ fallback secret ‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏≠ (`'fallback-secret'`)
- ‡∏ñ‡πâ‡∏≤ JWT_SECRET ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
- ‡∏ú‡∏π‡πâ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á JWT token ‡∏õ‡∏•‡∏≠‡∏°‡πÑ‡∏î‡πâ

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
const JWT_SECRET = process.env.JWT_SECRET;

if (!JWT_SECRET) {
  throw new Error('JWT_SECRET environment variable is required');
}

const secret = new TextEncoder().encode(JWT_SECRET);
```

### üü° ‡∏£‡∏∞‡∏î‡∏±‡∏ö HIGH

#### 1.3 Sensitive Data Logging

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** `src/authConfig.ts:13`

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
```typescript
console.log("credentials = ", credentials);
```
- Log ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• credentials ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡πà‡∏≠‡∏ô
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô log files ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// ‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î development ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
if (process.env.NODE_ENV === 'development') {
  console.log("auth attempt with cred-way:", credentials['cred-way']);
}
```

#### 1.4 Missing Input Sanitization

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå API routes

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ sanitize input ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á database
- ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ XSS ‡πÅ‡∏•‡∏∞ injection attacks
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÉ‡∏ô `src/app/api/events/route.ts` ‡∏£‡∏±‡∏ö HTML/text ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà sanitize

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á sanitization library
// npm install dompurify isomorphic-dompurify

import DOMPurify from 'isomorphic-dompurify';

// ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô HTML
const sanitizedDescription = DOMPurify.sanitize(description);
```

#### 1.5 Missing Rate Limiting

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏ó‡∏∏‡∏Å API endpoints

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ rate limiting ‡∏ö‡∏ô API endpoints
- ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ DDoS attacks ‡πÅ‡∏•‡∏∞ brute force attacks
- ‡∏ú‡∏π‡πâ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á requests ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á rate limiting middleware
// npm install express-rate-limit

// ‡∏™‡∏£‡πâ‡∏≤‡∏á middleware ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Next.js
// src/middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

// Simple in-memory rate limiter (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ Redis)
const rateLimitMap = new Map<string, { count: number; resetTime: number }>();

export function middleware(request: NextRequest) {
  const ip = request.ip ?? 'unknown';
  const now = Date.now();
  const limit = 100; // requests per minute
  const windowMs = 60 * 1000; // 1 minute

  const record = rateLimitMap.get(ip);
  
  if (!record || now > record.resetTime) {
    rateLimitMap.set(ip, { count: 1, resetTime: now + windowMs });
    return NextResponse.next();
  }

  if (record.count >= limit) {
    return new NextResponse('Too Many Requests', { status: 429 });
  }

  record.count++;
  return NextResponse.next();
}

export const config = {
  matcher: '/api/:path*',
};
```

---

## 2. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡πâ‡∏î (Code Quality Issues)

### üü° ‡∏£‡∏∞‡∏î‡∏±‡∏ö MEDIUM

#### 2.1 Mixed Use of console.log and console.error

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏ó‡∏±‡πà‡∏ß‡∏ó‡∏±‡πâ‡∏á codebase

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ `console.log` (3 ‡∏à‡∏∏‡∏î) ‡πÅ‡∏•‡∏∞ `console.error` (25 ‡∏à‡∏∏‡∏î) ‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢
- ‡πÑ‡∏°‡πà‡∏°‡∏µ structured logging
- ‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£ debug ‡πÅ‡∏•‡∏∞ monitor ‡πÉ‡∏ô production

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// ‡∏™‡∏£‡πâ‡∏≤‡∏á logger utility
// src/lib/logger.ts
type LogLevel = 'debug' | 'info' | 'warn' | 'error';

interface LogContext {
  [key: string]: unknown;
}

class Logger {
  private shouldLog(level: LogLevel): boolean {
    if (process.env.NODE_ENV === 'production') {
      return level === 'error' || level === 'warn';
    }
    return true;
  }

  private formatMessage(level: LogLevel, message: string, context?: LogContext): string {
    const timestamp = new Date().toISOString();
    const contextStr = context ? ` ${JSON.stringify(context)}` : '';
    return `[${timestamp}] [${level.toUpperCase()}] ${message}${contextStr}`;
  }

  debug(message: string, context?: LogContext) {
    if (this.shouldLog('debug')) {
      console.debug(this.formatMessage('debug', message, context));
    }
  }

  info(message: string, context?: LogContext) {
    if (this.shouldLog('info')) {
      console.info(this.formatMessage('info', message, context));
    }
  }

  warn(message: string, context?: LogContext) {
    if (this.shouldLog('warn')) {
      console.warn(this.formatMessage('warn', message, context));
    }
  }

  error(message: string, error?: Error, context?: LogContext) {
    if (this.shouldLog('error')) {
      console.error(this.formatMessage('error', message, {
        ...context,
        error: error?.message,
        stack: error?.stack,
      }));
    }
  }
}

export const logger = new Logger();
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```typescript
// ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà
console.log("Authorization Health id Code :", code);

// ‡∏î‡πâ‡∏ß‡∏¢
logger.debug("Authorization Health ID Code received", { codeLength: code.length });

// ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà
console.error(error);

// ‡∏î‡πâ‡∏ß‡∏¢
logger.error("Failed to create event", error as Error, { eventTitle: title });
```

#### 2.2 Inconsistent Error Messages

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** API routes ‡∏ï‡πà‡∏≤‡∏á ‡πÜ

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- Error messages ‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠
- ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
- ‡πÑ‡∏°‡πà‡∏°‡∏µ error codes ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö client ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// src/lib/errors.ts
export class ApiError extends Error {
  constructor(
    public statusCode: number,
    public code: string,
    message: string,
    public details?: unknown
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

export const ErrorCodes = {
  UNAUTHORIZED: 'UNAUTHORIZED',
  INVALID_TOKEN: 'INVALID_TOKEN',
  MISSING_FIELDS: 'MISSING_FIELDS',
  EVENT_NOT_FOUND: 'EVENT_NOT_FOUND',
  REGISTRATION_CLOSED: 'REGISTRATION_CLOSED',
  INVALID_FILE_TYPE: 'INVALID_FILE_TYPE',
  FILE_TOO_LARGE: 'FILE_TOO_LARGE',
} as const;

// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
if (!token) {
  throw new ApiError(401, ErrorCodes.UNAUTHORIZED, 'Missing authentication token');
}

// Error handler middleware
export function handleApiError(error: unknown) {
  if (error instanceof ApiError) {
    return NextResponse.json(
      {
        error: {
          code: error.code,
          message: error.message,
          details: error.details,
        },
      },
      { status: error.statusCode }
    );
  }

  logger.error('Unhandled error', error as Error);
  return NextResponse.json(
    {
      error: {
        code: 'INTERNAL_SERVER_ERROR',
        message: 'An unexpected error occurred',
      },
    },
    { status: 500 }
  );
}
```

#### 2.3 Duplicate Code

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏´‡∏•‡∏≤‡∏¢ API routes

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏°‡∏µ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö JWT
- ‡∏°‡∏µ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ã‡πâ‡∏≥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á eventId ‡πÅ‡∏•‡∏∞ validate parameters

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ã‡πâ‡∏≥:**
```typescript
// ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô /api/events/route.ts, /api/events/[id]/participants/route.ts ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
const token = getTokenFromRequest(request);
if (!token) {
  return new NextResponse('Unauthorized', { status: 401 });
}

const payload = await verifyToken(token);
if (!payload) {
  return new NextResponse('Invalid token', { status: 401 });
}
```

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// src/lib/api-helpers.ts
export async function requireAuth(request: Request) {
  const token = getTokenFromRequest(request);
  if (!token) {
    throw new ApiError(401, ErrorCodes.UNAUTHORIZED, 'Missing authentication token');
  }

  const payload = await verifyToken(token);
  if (!payload) {
    throw new ApiError(401, ErrorCodes.INVALID_TOKEN, 'Invalid or expired token');
  }

  return payload;
}

export function parseEventId(id: string): number {
  const eventId = Number(id);
  if (Number.isNaN(eventId)) {
    throw new ApiError(400, ErrorCodes.INVALID_PARAMETER, 'Invalid event ID');
  }
  return eventId;
}

// ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
export async function GET(request: Request, { params }: { params: Promise<Params> }) {
  try {
    const payload = await requireAuth(request);
    const resolvedParams = await params;
    const eventId = parseEventId(resolvedParams.id);
    
    // business logic here...
  } catch (error) {
    return handleApiError(error);
  }
}
```

#### 2.4 Magic Numbers and Strings

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏°‡∏µ magic numbers ‡πÅ‡∏•‡∏∞ strings ‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `registerMethod: 1=provider_id only, 2=form only, 3=both`
- ‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£ maintain ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// src/lib/constants.ts
export const RegisterMethod = {
  PROVIDER_ID_ONLY: 1,
  FORM_ONLY: 2,
  BOTH: 3,
} as const;

export const ParticipantStatus = {
  PENDING_REVIEW: 'pending_review',
  APPROVED: 'approved',
  REJECTED: 'rejected',
} as const;

export const FoodType = {
  NORMAL: 'normal',
  ISLAM: 'islam',
} as const;

export const FileUploadLimits = {
  MAX_SIZE_BYTES: 10 * 1024 * 1024, // 10MB
  ALLOWED_MIME_TYPES: ['application/pdf', 'image/jpeg', 'image/png'],
} as const;

export const JwtConfig = {
  SESSION_MAX_AGE: 60 * 60 * 25, // 25 hours
  PUBLIC_TOKEN_MAX_AGE: 60 * 60 * 24, // 24 hours
} as const;

// ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
const allowProviderId = registerMethod === RegisterMethod.PROVIDER_ID_ONLY || 
                        registerMethod === RegisterMethod.BOTH;
```

---

## 3. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Error Handling)

### üü° ‡∏£‡∏∞‡∏î‡∏±‡∏ö MEDIUM

#### 3.1 Swallowed Errors in Catch Blocks

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏´‡∏•‡∏≤‡∏¢‡∏à‡∏∏‡∏î ‡πÄ‡∏ä‡πà‡∏ô `src/lib/auth.ts:67-69`

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
```typescript
} catch {
  // If decoding fails, fall through to fetch a fresh token
}
```
- ‡∏°‡∏µ‡∏Å‡∏≤‡∏£ catch error ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà log ‡∏´‡∏£‡∏∑‡∏≠ handle
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£ debug

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
} catch (error) {
  logger.debug('Failed to decode JWT token', { error: error instanceof Error ? error.message : 'Unknown error' });
  // Fall through to fetch a fresh token
}
```

#### 3.2 Generic Error Messages to Client

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏´‡∏•‡∏≤‡∏¢ API endpoints

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
```typescript
} catch (error) {
  console.error(error);
  return new NextResponse('Internal Server Error', { status: 500 });
}
```
- ‡∏™‡πà‡∏á generic error message ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà client
- Client ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ error ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
- ‡πÑ‡∏°‡πà‡∏°‡∏µ error tracking

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
} catch (error) {
  logger.error('Failed to create event', error as Error, { 
    title,
    capacity,
    location 
  });
  
  // ‡πÉ‡∏ä‡πâ error handler ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
  return handleApiError(error);
}
```

---

## 4. ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û (Performance Recommendations)

### üü¢ ‡∏£‡∏∞‡∏î‡∏±‡∏ö LOW

#### 4.1 Missing Database Indexes

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** `prisma/schema.prisma`

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ indexes ‡∏ö‡∏ô columns ‡∏ó‡∏µ‡πà query ‡∏ö‡πà‡∏≠‡∏¢
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `Event.beginDate`, `Participant.eventId`, `Participant.providerId`

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```prisma
model Event {
  id          Int           @id @default(autoincrement())
  title       String
  beginDate   String        @default("")
  // ... other fields

  @@index([beginDate])
  @@index([status])
  @@index([regis_closed])
}

model Participant {
  id         Int      @id @default(autoincrement())
  eventId    Int
  providerId String?
  // ... other fields

  @@index([eventId])
  @@index([providerId])
  @@index([status])
}

model LoginLog {
  id           Int      @id @default(autoincrement())
  providerId   String
  datetime     DateTime @default(now())
  // ... other fields

  @@index([providerId])
  @@index([datetime])
}
```

#### 4.2 N+1 Query Problem

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô components ‡∏ó‡∏µ‡πà fetch ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÉ‡∏ä‡πâ Prisma's `include` ‡∏´‡∏£‡∏∑‡∏≠ `select` ‡πÄ‡∏û‡∏∑‡πà‡∏≠ eager load relationships
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Prisma query logs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ N+1 queries

```typescript
// ‚ùå N+1 Query
const events = await prisma.event.findMany();
for (const event of events) {
  const participants = await prisma.participant.findMany({
    where: { eventId: event.id }
  });
}

// ‚úÖ Single Query
const events = await prisma.event.findMany({
  include: {
    participants: true
  }
});
```

#### 4.3 Missing Pagination

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** API endpoints ‡∏ó‡∏µ‡πà return lists ‡πÄ‡∏ä‡πà‡∏ô `/api/events`

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ pagination ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö lists ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å
- ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ response ‡∏ä‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ memory ‡∏°‡∏≤‡∏Å

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// GET /api/events?page=1&limit=20
export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const page = Number(searchParams.get('page') ?? '1');
  const limit = Math.min(Number(searchParams.get('limit') ?? '20'), 100);
  const skip = (page - 1) * limit;

  const [events, total] = await Promise.all([
    prisma.event.findMany({
      skip,
      take: limit,
      orderBy: [
        { beginDate: 'asc' },
        { id: 'asc' },
      ],
    }),
    prisma.event.count(),
  ]);

  return NextResponse.json({
    events,
    pagination: {
      page,
      limit,
      total,
      totalPages: Math.ceil(total / limit),
    },
  });
}
```

---

## 5. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î (Documentation & Code Clarity)

### üü¢ ‡∏£‡∏∞‡∏î‡∏±‡∏ö LOW

#### 5.1 Missing API Documentation

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ API
- Frontend developers ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à API

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `API_DOCUMENTATION.md`:

```markdown
# API Documentation

## Authentication

All API endpoints require JWT authentication via `Authorization: Bearer <token>` header.

### Get Token
- **Endpoint:** `GET /api/auth/token` (session-based) or `GET /api/auth/public-token`
- **Response:** `{ "token": "..." }`

## Events

### List Events
- **Endpoint:** `GET /api/events`
- **Query Params:** 
  - `page` (optional, default: 1)
  - `limit` (optional, default: 20, max: 100)
- **Response:** `{ "events": [...], "pagination": {...} }`

### Create Event
- **Endpoint:** `POST /api/events`
- **Body:** `{ title, beginDate, time, location, capacity, description, ... }`
- **Response:** `{ "event": {...} }`

...
```

#### 5.2 Missing JSDoc Comments

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- Functions ‡πÑ‡∏°‡πà‡∏°‡∏µ JSDoc comments
- ‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
/**
 * Generates a JWT token for API authentication
 * @param payload - The payload to encode in the token
 * @param payload.userId - User identifier
 * @param payload.providerId - Optional Provider ID from Health/Provider ID system
 * @returns A signed JWT token valid for 24 hours
 * @throws {Error} If JWT_SECRET is not configured
 */
export async function generateToken(payload: Omit<JWTPayload, 'exp'>): Promise<string> {
  // ...
}
```

#### 5.3 Unclear Variable Names

**‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:** ‡∏´‡∏•‡∏≤‡∏¢‡∏à‡∏∏‡∏î

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `is_auth`, `regis_closed` (inconsistent naming)

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÉ‡∏ä‡πâ camelCase consistently ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö JavaScript/TypeScript
- ‡πÉ‡∏ä‡πâ snake_case ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö database columns (Prisma)
- ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô

```typescript
// ‚ùå Unclear
const is_auth = searchParams.get('is_auth') === 'yes';

// ‚úÖ Clear
const shouldAuthenticate = searchParams.get('is_auth') === 'yes';

// ‚ùå Inconsistent
regis_closed // snake_case

// ‚úÖ Consistent (in code)
registrationClosed // camelCase
// Keep snake_case in database schema
```

---

## 6. ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° (Architecture Recommendations)

### üü¢ ‡∏£‡∏∞‡∏î‡∏±‡∏ö LOW

#### 6.1 Missing Input Validation Layer

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- Input validation ‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÉ‡∏ô API routes
- ‡πÑ‡∏°‡πà‡∏°‡∏µ schema validation

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
‡πÉ‡∏ä‡πâ Zod ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö input validation:

```typescript
// npm install zod

// src/lib/schemas.ts
import { z } from 'zod';

export const CreateEventSchema = z.object({
  title: z.string().min(1).max(200),
  beginDate: z.string().regex(/^\d{4}-\d{2}-\d{2}$/),
  endDate: z.string().regex(/^\d{4}-\d{2}-\d{2}$/).optional().nullable(),
  time: z.string().min(1),
  location: z.string().min(1),
  coordinatorName: z.string().optional().nullable(),
  capacity: z.number().int().positive(),
  description: z.string().min(1),
  latitude: z.number().min(-90).max(90).optional().nullable(),
  longitude: z.number().min(-180).max(180).optional().nullable(),
  enableCheckInRadius: z.boolean().default(false),
  checkInRadiusMeters: z.number().int().positive().optional().nullable(),
  registerMethod: z.enum(['1', '2', '3']).default('3'),
  needOriginApprovePaper: z.boolean().default(false),
});

// ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô API route
export async function POST(request: Request) {
  try {
    const body = await request.json();
    const validatedData = CreateEventSchema.parse(body);
    
    // ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ validatedData ‡∏°‡∏µ type-safe ‡πÅ‡∏•‡∏∞ validated ‡πÅ‡∏•‡πâ‡∏ß
    const event = await prisma.event.create({
      data: validatedData
    });
    
    return NextResponse.json({ event }, { status: 201 });
  } catch (error) {
    if (error instanceof z.ZodError) {
      return NextResponse.json(
        { error: { code: 'VALIDATION_ERROR', details: error.errors } },
        { status: 400 }
      );
    }
    return handleApiError(error);
  }
}
```

#### 6.2 Monolithic API Routes

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- API route files ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏°‡∏≤‡∏Å (‡πÄ‡∏ä‡πà‡∏ô `/api/events/[id]/participants/route.ts` ‡∏°‡∏µ 385 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
- ‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£ maintain ‡πÅ‡∏•‡∏∞ test

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
‡πÅ‡∏¢‡∏Å business logic ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô services:

```typescript
// src/services/participant-service.ts
export class ParticipantService {
  async createParticipant(
    eventId: number,
    data: CreateParticipantData,
    options?: { skipValidation?: boolean }
  ) {
    // Business logic here
    return prisma.participant.create({ data });
  }

  async updateParticipant(
    participantId: number,
    data: UpdateParticipantData
  ) {
    // Business logic here
    return prisma.participant.update({
      where: { id: participantId },
      data,
    });
  }

  async deleteParticipant(participantId: number) {
    // Business logic here
  }
}

// src/app/api/events/[id]/participants/route.ts
const participantService = new ParticipantService();

export async function POST(request: Request, { params }: { params: Promise<Params> }) {
  try {
    const payload = await requireAuth(request);
    const resolvedParams = await params;
    const eventId = parseEventId(resolvedParams.id);
    const form = await request.formData();
    
    // Validate input
    const data = validateParticipantForm(form);
    
    // Call service
    const participant = await participantService.createParticipant(eventId, data);
    
    return NextResponse.json({ participant }, { status: 201 });
  } catch (error) {
    return handleApiError(error);
  }
}
```

#### 6.3 Missing Environment Validation

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ environment variables ‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ô startup
- ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î runtime errors ‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á

**‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```typescript
// src/lib/env.ts
import { z } from 'zod';

const envSchema = z.object({
  NODE_ENV: z.enum(['development', 'production', 'test']).default('development'),
  AUTH_SECRET: z.string().min(32),
  AUTH_URL: z.string().url(),
  HEALTH_CLIENT_ID: z.string().min(1),
  HEALTH_CLIENT_SECRET: z.string().min(1),
  HEALTH_REDIRECT_URI: z.string().url(),
  PROVIDER_CLIENT_ID: z.string().min(1),
  PROVIDER_CLIENT_SECRET: z.string().min(1),
  JWT_SECRET: z.string().min(32),
  DATABASE_URL: z.string().optional(),
  NEXT_PUBLIC_SITE_URL: z.string().url().optional(),
});

export type Env = z.infer<typeof envSchema>;

function validateEnv(): Env {
  try {
    return envSchema.parse(process.env);
  } catch (error) {
    if (error instanceof z.ZodError) {
      const missing = error.errors.map(e => e.path.join('.')).join(', ');
      throw new Error(`Missing or invalid environment variables: ${missing}`);
    }
    throw error;
  }
}

// Call this at app startup
export const env = validateEnv();

// ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
import { env } from '@/lib/env';
const token = await fetch(env.HEALTH_CLIENT_ID);
```

---

## ‡∏™‡∏£‡∏∏‡∏õ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### Priority 1 - CRITICAL (‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)
1. ‚úÖ ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å repository ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á `.env.example`
2. ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç JWT secret fallback ‡πÉ‡∏ô `src/lib/jwt.ts`
3. ‚úÖ Rotate secrets ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å expose (AUTH_SECRET, JWT_SECRET, HEALTH_CLIENT_SECRET, PROVIDER_CLIENT_SECRET)

### Priority 2 - HIGH (‡∏Ñ‡∏ß‡∏£‡πÅ‡∏Å‡πâ‡πÉ‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ)
1. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° rate limiting
2. ‚úÖ ‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î sensitive data logging
3. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° input sanitization ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô XSS

### Priority 3 - MEDIUM (‡∏Ñ‡∏ß‡∏£‡πÅ‡∏Å‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏≠‡∏±‡∏ô‡πÉ‡∏Å‡∏•‡πâ)
1. ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á structured logger
2. ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á consistent error handling
3. ‚úÖ Refactor duplicate code
4. ‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô magic numbers/strings ‡πÄ‡∏õ‡πá‡∏ô constants

### Priority 4 - LOW (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤)
1. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° database indexes
2. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° pagination
3. ‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô API documentation
4. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° JSDoc comments
5. ‚úÖ Refactor ‡πÄ‡∏õ‡πá‡∏ô service layer
6. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° environment validation

---

## ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

1. **`src/lib/logger.ts`** - Structured logging utility
2. **`src/lib/errors.ts`** - Custom error classes ‡πÅ‡∏•‡∏∞ error codes
3. **`src/lib/constants.ts`** - Application constants
4. **`src/lib/api-helpers.ts`** - Reusable API utilities
5. **`src/lib/schemas.ts`** - Zod validation schemas
6. **`src/lib/env.ts`** - Environment validation
7. **`src/middleware.ts`** - Rate limiting ‡πÅ‡∏•‡∏∞ middleware ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
8. **`src/services/`** - Service layer ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö business logic
9. **`API_DOCUMENTATION.md`** - API documentation
10. **`.env.example`** - Template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö environment variables

---

## ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

### Testing
- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° unit tests ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö business logic
- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° integration tests ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API endpoints
- ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ä‡πâ Jest + Testing Library

### Monitoring
- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° monitoring ‡πÅ‡∏•‡∏∞ alerting (‡πÄ‡∏ä‡πà‡∏ô Sentry, DataDog)
- ‡∏Ñ‡∏ß‡∏£ log request/response times
- ‡∏Ñ‡∏ß‡∏£ track error rates

### Security Headers
- ‡πÄ‡∏û‡∏¥‡πà‡∏° security headers (CSP, X-Frame-Options, etc.)
- ‡πÉ‡∏ä‡πâ HTTPS ‡πÉ‡∏ô production
- ‡πÄ‡∏û‡∏¥‡πà‡∏° CORS configuration ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

### CI/CD
- ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ automated tests ‡πÉ‡∏ô CI pipeline
- ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ automated security scanning
- ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ automated deployment process

---

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Å‡∏≤‡∏£ review ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ï‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏à‡∏£‡∏¥‡∏á
