{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///E:/NextJS/plk-regis-meet/src/authConfig.ts"],"sourcesContent":["import NextAuth, { type Session, type NextAuthConfig } from \"next-auth\";\r\nimport type { JWT } from \"next-auth/jwt\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\n\r\nconst authOptions: NextAuthConfig = {\r\n  session: {\r\n    strategy: 'jwt',\r\n    maxAge: 60 * 60 * 25, // 25 hours\r\n  },\r\n  providers: [\r\n    CredentialsProvider({\r\n      async authorize(credentials) {\r\n        console.log(\"credentials = \", credentials);\r\n        if (credentials['cred-way'] == 'user-pass') {\r\n          // ยังไม่เชื่อมต่อฐานข้อมูลจริง: ให้ login แบบ user-pass ไม่สำเร็จไปก่อน\r\n          /*\r\n           NOTE: โค้ด prisma ด้านล่างถูก comment ไว้ เพื่อให้ build ผ่าน\r\n           แต่ยังเก็บเป็นตัวอย่างเผื่อเชื่อมฐานข้อมูลภายหลัง\r\n\r\n           const user = await prisma.user.findUnique({\r\n             where: {\r\n               username: credentials?.username as string,\r\n             },\r\n           });\r\n           if (!user) {\r\n             return null; // ทำให้ auth fail และ redirect กลับหน้า sign-in\r\n           }\r\n           return {\r\n             name: user.username,\r\n             profile: JSON.stringify(user),\r\n             ssj_department: (user as any).ssj_department,\r\n           };\r\n          */\r\n\r\n          return null; // จะทำให้ authentication fail และ redirect กลับหน้า sign-in\r\n        }\r\n        return {\r\n          name: 'provider-id',\r\n          profile: credentials.profile!\r\n        };\r\n      }\r\n    })\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }: { token: JWT; user?: any }) {\r\n      if (user) {      \r\n        token.profile = (user as any).profile;      \r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }: { session: Session; token: JWT }) {\r\n      if (token && session.user) {\r\n        (session.user as any).profile = (token as any).profile; // Add user profile to the session\r\n      }\r\n      return session;\r\n    },\r\n  },\r\n}\r\n\r\nexport const {\r\n  handlers,\r\n  auth,\r\n  signIn,\r\n  signOut,\r\n} = NextAuth(authOptions);"],"names":[],"mappings":";;;;;;;;;;AAAA;AAEA;AAAA;;;AAEA,MAAM,cAA8B;IAClC,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK;IACpB;IACA,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM,WAAU,WAAW;gBACzB,QAAQ,GAAG,CAAC,kBAAkB;gBAC9B,IAAI,WAAW,CAAC,WAAW,IAAI,aAAa;oBAC1C,wEAAwE;oBACxE;;;;;;;;;;;;;;;;;UAiBA,GAEA,OAAO,MAAM,4DAA4D;gBAC3E;gBACA,OAAO;oBACL,MAAM;oBACN,SAAS,YAAY,OAAO;gBAC9B;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAA8B;YACnD,IAAI,MAAM;gBACR,MAAM,OAAO,GAAG,AAAC,KAAa,OAAO;YACvC;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAoC;YAChE,IAAI,SAAS,QAAQ,IAAI,EAAE;gBACxB,QAAQ,IAAI,CAAS,OAAO,GAAG,AAAC,MAAc,OAAO,EAAE,kCAAkC;YAC5F;YACA,OAAO;QACT;IACF;AACF;AAEO,MAAM,EACX,QAAQ,EACR,IAAI,EACJ,MAAM,EACN,OAAO,EACR,GAAG,IAAA,gKAAQ,EAAC"}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///E:/NextJS/plk-regis-meet/src/app/profile/page.tsx"],"sourcesContent":["import { auth } from \"@/authConfig\";\n\nexport default async function ProfilePage() {\n  let session: any = null;\n\n  try {\n    session = await auth();\n  } catch (error) {\n    // กรณี JWTSessionError หรือปัญหา session อื่น ๆ ให้ถือว่าเป็นยังไม่ล็อกอิน\n    console.error(\"[profile] auth() error\", error);\n    session = null;\n  }\n\n  const rawProfile = (session?.user as any)?.profile as string | undefined;\n\n  let parsedProfile: unknown = null;\n\n  if (rawProfile) {\n    try {\n      parsedProfile = JSON.parse(rawProfile);\n    } catch {\n      parsedProfile = rawProfile;\n    }\n  }\n\n  const displayData =\n    parsedProfile ?? { message: \"No provider profile found in session\" };\n\n  return (\n    <main className=\"min-h-screen bg-slate-50 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-3xl bg-white shadow rounded-lg p-6\">\n        <h1 className=\"text-xl font-semibold mb-4\">Provider ID Profile (JSON)</h1>\n        {!session && (\n          <p className=\"text-sm text-red-500 mb-4\">\n            ไม่พบ session กรุณาเข้าสู่ระบบผ่าน Health ID ก่อน\n          </p>\n        )}\n        <pre className=\"text-xs bg-slate-900 text-slate-100 rounded-md p-4 overflow-auto\">\n{JSON.stringify(displayData, null, 2)}\n        </pre>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;;AAEe,eAAe;IAC5B,IAAI,UAAe;IAEnB,IAAI;QACF,UAAU,MAAM,IAAA,yHAAI;IACtB,EAAE,OAAO,OAAO;QACd,2EAA2E;QAC3E,QAAQ,KAAK,CAAC,0BAA0B;QACxC,UAAU;IACZ;IAEA,MAAM,aAAc,SAAS,MAAc;IAE3C,IAAI,gBAAyB;IAE7B,IAAI,YAAY;QACd,IAAI;YACF,gBAAgB,KAAK,KAAK,CAAC;QAC7B,EAAE,OAAM;YACN,gBAAgB;QAClB;IACF;IAEA,MAAM,cACJ,iBAAiB;QAAE,SAAS;IAAuC;IAErE,qBACE,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA6B;;;;;;gBAC1C,CAAC,yBACA,8OAAC;oBAAE,WAAU;8BAA4B;;;;;;8BAI3C,8OAAC;oBAAI,WAAU;8BACtB,KAAK,SAAS,CAAC,aAAa,MAAM;;;;;;;;;;;;;;;;;AAKnC"}}]
}