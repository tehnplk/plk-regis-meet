{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../src/app/database/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","'use client';\n\nimport { useEffect, useState } from 'react';\nimport { Header } from '../_components/event-ui';\n\ninterface TableSummary {\n  name: string;\n  count: number;\n}\n\nexport default function DatabasePage() {\n  const [tables, setTables] = useState<TableSummary[]>([]);\n  const [loadingTables, setLoadingTables] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const [selectedTable, setSelectedTable] = useState<string | null>(null);\n  const [rows, setRows] = useState<any[] | null>(null);\n  const [loadingRows, setLoadingRows] = useState(false);\n  const [rowsError, setRowsError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const loadTables = async () => {\n      try {\n        const res = await fetch('/api/database');\n        if (!res.ok) {\n          throw new Error('Failed to load tables');\n        }\n        const data = await res.json();\n        setTables(data.tables ?? []);\n        setError(null);\n      } catch (e) {\n        console.error(e);\n        setError('ไม่สามารถโหลดรายการตารางได้');\n      } finally {\n        setLoadingTables(false);\n      }\n    };\n\n    loadTables();\n  }, []);\n\n  const handleView = async (tableName: string) => {\n    setSelectedTable(tableName);\n    setRows(null);\n    setRowsError(null);\n    setLoadingRows(true);\n\n    try {\n      const res = await fetch(`/api/database/${tableName}`);\n      if (!res.ok) {\n        if (res.status === 404) {\n          setRowsError('ไม่พบตารางที่เลือก');\n        } else {\n          setRowsError('ไม่สามารถโหลดข้อมูลตารางได้');\n        }\n        setRows([]);\n        return;\n      }\n      const data = await res.json();\n      setRows(data.rows ?? []);\n    } catch (e) {\n      console.error(e);\n      setRowsError('ไม่สามารถโหลดข้อมูลตารางได้');\n      setRows([]);\n    } finally {\n      setLoadingRows(false);\n    }\n  };\n\n  const renderRowsTable = () => {\n    if (!selectedTable) return null;\n\n    let content;\n\n    if (loadingRows) {\n      content = (\n        <p className=\"text-sm text-gray-600\">\n          กำลังโหลดข้อมูลจากตาราง {selectedTable}...\n        </p>\n      );\n    } else if (rowsError) {\n      content = <p className=\"text-sm text-red-600\">{rowsError}</p>;\n    } else if (!rows || rows.length === 0) {\n      content = <p className=\"text-sm text-gray-500\">ไม่พบข้อมูลในตารางนี้</p>;\n    } else {\n      const columns = Object.keys(rows[0]);\n      content = (\n        <div className=\"border border-gray-200 rounded-lg overflow-hidden\">\n          <div className=\"px-4 py-2 bg-gray-50 border-b border-gray-200 text-sm text-gray-700 font-medium\">\n            SELECT * FROM {selectedTable} (สูงสุด 200 แถว)\n          </div>\n          <div className=\"overflow-auto\">\n            <table className=\"w-full text-left border-collapse text-sm\">\n              <thead>\n                <tr className=\"bg-gray-50 border-b border-gray-200 text-xs uppercase text-gray-500\">\n                  {columns.map((col) => (\n                    <th key={col} className=\"px-3 py-2 whitespace-nowrap\">\n                      {col}\n                    </th>\n                  ))}\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-gray-100\">\n                {rows.map((row, idx) => (\n                  <tr key={idx} className=\"hover:bg-blue-50/40\">\n                    {columns.map((col) => {\n                      const value = row[col];\n                      const isPrimitive =\n                        value === null ||\n                        ['string', 'number', 'boolean'].includes(typeof value);\n\n                      return (\n                        <td key={col} className=\"px-3 py-2 align-top\">\n                          <pre className=\"text-xs text-gray-800 whitespace-pre-wrap break-all\">\n                            {isPrimitive ? String(value ?? '') : JSON.stringify(value)}\n                          </pre>\n                        </td>\n                      );\n                    })}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"fixed inset-0 z-50 bg-black/60 flex items-stretch md:items-center justify-center\">\n        <div className=\"bg-white w-full h-full md:h-[90vh] md:w-[90vw] rounded-none md:rounded-2xl shadow-xl flex flex-col\">\n          <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200\">\n            <div>\n              <p className=\"text-xs text-gray-500 uppercase tracking-wide\">Table</p>\n              <p className=\"text-sm font-semibold text-gray-900\">{selectedTable}</p>\n            </div>\n            <button\n              type=\"button\"\n              onClick={() => {\n                setSelectedTable(null);\n                setRows(null);\n                setRowsError(null);\n              }}\n              className=\"px-3 py-1.5 text-xs rounded-lg border border-gray-300 bg-white hover:bg-gray-50 text-gray-700\"\n            >\n              ปิด\n            </button>\n          </div>\n          <div className=\"flex-1 overflow-auto p-4\">\n            {content}\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 font-sans text-gray-900\">\n      <Header />\n      <main className=\"max-w-6xl mx-auto p-6 space-y-6\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Database Viewer</h2>\n          <p className=\"text-gray-600 text-sm mt-1\">\n            หน้านี้ใช้สำหรับดูข้อมูลตัวอย่างแบบ SELECT * จากทุกตารางในฐานข้อมูล (SQLite).\n          </p>\n        </div>\n\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-4\">\n          {loadingTables && <p className=\"text-sm text-gray-600\">กำลังโหลดรายการตาราง...</p>}\n          {!loadingTables && error && (\n            <p className=\"text-sm text-red-600\">{error}</p>\n          )}\n          {!loadingTables && !error && (\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full text-left border-collapse text-sm\">\n                <thead>\n                  <tr className=\"bg-gray-50 border-b border-gray-200 text-xs uppercase text-gray-500\">\n                    <th className=\"px-3 py-2\">ลำดับ</th>\n                    <th className=\"px-3 py-2\">table_name</th>\n                    <th className=\"px-3 py-2\">record</th>\n                    <th className=\"px-3 py-2 text-right\">view</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-100\">\n                  {tables.map((t, index) => (\n                    <tr key={t.name} className=\"hover:bg-blue-50/40\">\n                      <td className=\"px-3 py-2\">{index + 1}</td>\n                      <td className=\"px-3 py-2 font-mono text-xs\">{t.name}</td>\n                      <td className=\"px-3 py-2\">{t.count}</td>\n                      <td className=\"px-3 py-2 text-right\">\n                        <button\n                          type=\"button\"\n                          onClick={() => handleView(t.name)}\n                          className=\"px-3 py-1 text-xs rounded-lg border border-gray-300 bg-white hover:bg-gray-50 text-gray-700\"\n                        >\n                          view\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                  {tables.length === 0 && (\n                    <tr>\n                      <td colSpan={4} className=\"px-3 py-4 text-center text-gray-500 text-sm\">\n                        ไม่พบตารางในฐานข้อมูล\n                      </td>\n                    </tr>\n                  )}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-4\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">ข้อมูลตาราง</h3>\n          <p className=\"text-sm text-gray-500\">เลือกตารางจากด้านบนแล้วกดปุ่ม view เพื่อดูข้อมูล</p>\n        </div>\n\n        {renderRowsTable()}\n      </main>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","React","AppRouterContext","HooksClientContext","ServerInsertedHtml","process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","ReactJsxRuntime"],"mappings":"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","ignoreList":[0,1,2,3,4,5]}